<svg viewBox="0 0 800 680" xmlns="http://www.w3.org/2000/svg">
  <!-- Title -->
  <text x="400" y="40" font-family="Arial" font-size="24" text-anchor="middle" font-weight="bold">Recursive Stack Sort Visualization</text>
  
  <!-- Initial Stack -->
  <rect x="80" y="100" width="120" height="50" fill="#f9d6a4" stroke="#333" stroke-width="2"/>
  <text x="140" y="130" font-family="Arial" font-size="20" text-anchor="middle">5</text>
  <rect x="80" y="150" width="120" height="50" fill="#f9d6a4" stroke="#333" stroke-width="2"/>
  <text x="140" y="180" font-family="Arial" font-size="20" text-anchor="middle">1</text>
  <rect x="80" y="200" width="120" height="50" fill="#f9d6a4" stroke="#333" stroke-width="2"/>
  <text x="140" y="230" font-family="Arial" font-size="20" text-anchor="middle">3</text>
  <rect x="80" y="250" width="120" height="50" fill="#f9d6a4" stroke="#333" stroke-width="2"/>
  <text x="140" y="280" font-family="Arial" font-size="20" text-anchor="middle">2</text>
  <text x="140" y="320" font-family="Arial" font-size="16" text-anchor="middle">Original Stack</text>
  
  <!-- Pop 5 -->
  <rect x="280" y="100" width="120" height="50" fill="#f9d6a4" stroke="#333" stroke-width="2"/>
  <text x="340" y="130" font-family="Arial" font-size="20" text-anchor="middle">1</text>
  <rect x="280" y="150" width="120" height="50" fill="#f9d6a4" stroke="#333" stroke-width="2"/>
  <text x="340" y="180" font-family="Arial" font-size="20" text-anchor="middle">3</text>
  <rect x="280" y="200" width="120" height="50" fill="#f9d6a4" stroke="#333" stroke-width="2"/>
  <text x="340" y="230" font-family="Arial" font-size="20" text-anchor="middle">2</text>
  <text x="340" y="270" font-family="Arial" font-size="16" text-anchor="middle">Pop 5</text>
  
  <circle cx="230" cy="125" r="25" fill="#ff9999" stroke="#333" stroke-width="2"/>
  <text x="230" y="132" font-family="Arial" font-size="20" text-anchor="middle">5</text>
  <text x="230" y="170" font-family="Arial" font-size="14" text-anchor="middle">Temp</text>
  
  <!-- Pop 1 -->
  <rect x="480" y="100" width="120" height="50" fill="#f9d6a4" stroke="#333" stroke-width="2"/>
  <text x="540" y="130" font-family="Arial" font-size="20" text-anchor="middle">3</text>
  <rect x="480" y="150" width="120" height="50" fill="#f9d6a4" stroke="#333" stroke-width="2"/>
  <text x="540" y="180" font-family="Arial" font-size="20" text-anchor="middle">2</text>
  <text x="540" y="220" font-family="Arial" font-size="16" text-anchor="middle">Pop 1</text>
  
  <circle cx="430" cy="125" r="25" fill="#ff9999" stroke="#333" stroke-width="2"/>
  <text x="430" y="132" font-family="Arial" font-size="20" text-anchor="middle">1</text>
  <text x="430" y="170" font-family="Arial" font-size="14" text-anchor="middle">Temp</text>
  
  <!-- Pop 3 -->
  <rect x="680" y="100" width="120" height="50" fill="#f9d6a4" stroke="#333" stroke-width="2"/>
  <text x="740" y="130" font-family="Arial" font-size="20" text-anchor="middle">2</text>
  <text x="740" y="170" font-family="Arial" font-size="16" text-anchor="middle">Pop 3</text>
  
  <circle cx="630" cy="125" r="25" fill="#ff9999" stroke="#333" stroke-width="2"/>
  <text x="630" y="132" font-family="Arial" font-size="20" text-anchor="middle">3</text>
  <text x="630" y="170" font-family="Arial" font-size="14" text-anchor="middle">Temp</text>
  
  <!-- Base Case -->
  <rect x="80" y="400" width="120" height="50" fill="#c3e6cb" stroke="#333" stroke-width="2" rx="5"/>
  <text x="140" y="430" font-family="Arial" font-size="20" text-anchor="middle">2</text>
  <text x="140" y="475" font-family="Arial" font-size="16" text-anchor="middle">Base Stack</text>
  
  <!-- Insert 3 -->
  <rect x="280" y="350" width="120" height="50" fill="#c3e6cb" stroke="#333" stroke-width="2" rx="5"/>
  <text x="340" y="380" font-family="Arial" font-size="20" text-anchor="middle">3</text>
  <rect x="280" y="400" width="120" height="50" fill="#c3e6cb" stroke="#333" stroke-width="2" rx="5"/>
  <text x="340" y="430" font-family="Arial" font-size="20" text-anchor="middle">2</text>
  <text x="340" y="475" font-family="Arial" font-size="16" text-anchor="middle">Insert 3</text>
  
  <circle cx="230" cy="375" r="25" fill="#ff9999" stroke="#333" stroke-width="2"/>
  <text x="230" y="382" font-family="Arial" font-size="20" text-anchor="middle">3</text>
  <text x="230" y="420" font-family="Arial" font-size="14" text-anchor="middle">Temp</text>
  
  <!-- Insert 1 -->
  <rect x="480" y="300" width="120" height="50" fill="#c3e6cb" stroke="#333" stroke-width="2" rx="5"/>
  <text x="540" y="330" font-family="Arial" font-size="20" text-anchor="middle">3</text>
  <rect x="480" y="350" width="120" height="50" fill="#c3e6cb" stroke="#333" stroke-width="2" rx="5"/>
  <text x="540" y="380" font-family="Arial" font-size="20" text-anchor="middle">2</text>
  <rect x="480" y="400" width="120" height="50" fill="#c3e6cb" stroke="#333" stroke-width="2" rx="5"/>
  <text x="540" y="430" font-family="Arial" font-size="20" text-anchor="middle">1</text>
  <text x="540" y="475" font-family="Arial" font-size="16" text-anchor="middle">Insert 1</text>
  
  <circle cx="430" cy="425" r="25" fill="#ff9999" stroke="#333" stroke-width="2"/>
  <text x="430" y="432" font-family="Arial" font-size="20" text-anchor="middle">1</text>
  <text x="430" y="470" font-family="Arial" font-size="14" text-anchor="middle">Temp</text>
  
  <!-- Insert 5 -->
  <rect x="680" y="250" width="120" height="50" fill="#c3e6cb" stroke="#333" stroke-width="2" rx="5"/>
  <text x="740" y="280" font-family="Arial" font-size="20" text-anchor="middle">5</text>
  <rect x="680" y="300" width="120" height="50" fill="#c3e6cb" stroke="#333" stroke-width="2" rx="5"/>
  <text x="740" y="330" font-family="Arial" font-size="20" text-anchor="middle">3</text>
  <rect x="680" y="350" width="120" height="50" fill="#c3e6cb" stroke="#333" stroke-width="2" rx="5"/>
  <text x="740" y="380" font-family="Arial" font-size="20" text-anchor="middle">2</text>
  <rect x="680" y="400" width="120" height="50" fill="#c3e6cb" stroke="#333" stroke-width="2" rx="5"/>
  <text x="740" y="430" font-family="Arial" font-size="20" text-anchor="middle">1</text>
  <text x="740" y="475" font-family="Arial" font-size="16" text-anchor="middle">Insert 5</text>
  
  <circle cx="630" cy="275" r="25" fill="#ff9999" stroke="#333" stroke-width="2"/>
  <text x="630" y="282" font-family="Arial" font-size="20" text-anchor="middle">5</text>
  <text x="630" y="320" font-family="Arial" font-size="14" text-anchor="middle">Temp</text>
  
  <!-- Arrows -->
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#333"/>
    </marker>
  </defs>
  
  <!-- Horizontal arrows for popping phase -->
  <line x1="210" y1="175" x2="270" y2="175" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>
  <line x1="410" y1="175" x2="470" y2="175" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>
  <line x1="610" y1="175" x2="670" y2="175" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>
  
  <!-- Vertical arrow for base case -->
  <line x1="740" y1="200" x2="740" y2="240" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>
  <line x1="140" y1="340" x2="140" y2="390" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>
  
  <!-- Horizontal arrows for inserting phase -->
  <line x1="210" y1="425" x2="270" y2="425" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>
  <line x1="410" y1="425" x2="470" y2="425" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>
  <line x1="610" y1="425" x2="670" y2="425" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>
  
  <!-- Labels for the phases -->
  <text x="400" y="80" font-family="Arial" font-size="18" text-anchor="middle" font-weight="bold">Phase 1: Recursively Pop Elements</text>
  <text x="400" y="530" font-family="Arial" font-size="18" text-anchor="middle" font-weight="bold">Phase 2: Insert in Sorted Order</text>
  
  <!-- insertSorted visualization -->
  <rect x="60" y="560" width="680" height="100" fill="#e2e3e5" stroke="#333" stroke-width="2" rx="10"/>
  <text x="400" y="585" font-family="Arial" font-size="16" text-anchor="middle" font-weight="bold">How insertSorted works</text>
  <text x="400" y="615" font-family="Arial" font-size="14" text-anchor="middle">1. If stack is empty or value > top element: Push directly</text>
  <text x="400" y="640" font-family="Arial" font-size="14" text-anchor="middle">2. If value &lt; top element: Pop top, insert value recursively, then push top back</text>
</svg>
